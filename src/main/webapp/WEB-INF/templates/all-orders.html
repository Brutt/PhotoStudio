<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
          integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <title>Orders Journal</title>
</head>
<body class="container">
<div id="parameters">
    <div class="form-row">
        <div class="form-group col-md-6">
            <label for="inputDateFrom">From</label>
            <input type="date" class="data-field form-control select-selected" id="inputDateFrom"
                   placeholder="Search by from Date"
                   name="filterFromDate">
        </div>
        <div class="form-group col-md-6">
            <label for="inputDateTo">To</label>
            <input type="date" class="data-field form-control select-selected" id="inputDateTo"
                   placeholder="Search by to Date"
                   name="filterToDate">
        </div>
    </div>
    <div class="form-row">
        <div class="form-group col-md-6">
            <label for="inputEmail">Email</label>
            <input type="email" class="form-control select-selected" id="inputEmail" placeholder="email"
                   name="filterEmail">
        </div>
        <div class="form-group col-md-6">
            <label for="inputPhoneNumber">Phone</label>
            <input type="tel" pattern="38 ([0-9]{3}) [0-9]{3}-[0-9]{2}-[0-9]{2}"
                   placeholder="38 (XXX) XXX-XX-XX"
                   class="form-control select-selected" id="inputPhoneNumber" name="filterPhoneNumber">
        </div>
    </div>
    <div class="form-row">
        <div class="form-group col-md-6">
            <label for="inputState">State</label>
            <select id="inputState" name="filterOrderStatus" class="form-control">
                <option selected></option>
                <option>New</option>
                <option>View and Select</option>
                <option>Selected</option>
                <option>Ready</option>
            </select>
        </div>
    </div>
    <div class="form-group">
        <a href="#" onclick="parammeterize()" id="add_parameters"
           class="btn btn-submit btn-outline-dark button">Apply</a>
    </div>
</div>

<table class="table table-hover">
    <thead>
    <tr>
        <th scope="col">Number</th>
        <th scope="col">Date</th>
        <th scope="col">Status</th>
        <th scope="col">User(Email/Phone)</th>
    </tr>
    </thead>
    <tbody>
    <div th:each="order : ${orders}">
        <tr>
            <th scope="row" th:text="${order.id}"></th>
            <td th:text="${order.orderDate}"></td>
            <td th:text="${order.status}"></td>
            <td>
                <div th:if="${order.phoneNumber == null}" th:text="${order.email}"></div>
                <div th:if="${order.phoneNumber != null}" th:text="${order.email} + '/' +${order.phoneNumber}"></div>
            </td>
        </tr>
    </div>
    </tbody>
</table>
</body>
<script>
    function parammeterize() {
        let url = document.location.origin + '/orders';
        let params = {};
        document.querySelectorAll('#parameters .select-selected').forEach((element) => {
            if (element.value.length > 0)
                params[element.name] = element.value;
        });

        let e = document.getElementById("inputState");
        let optionState = e.options[e.selectedIndex];
        if (optionState.text.length > 0) {
            params[e.name] = optionState.text;
        }

        let query = Object.keys(params)
            .map(k => k + '=' + params[k])
            .join('&');
        url += '?' + query;
        document.getElementById("add_parameters").href = url;
    }
</script>
</html>